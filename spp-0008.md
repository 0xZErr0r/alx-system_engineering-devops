## Preamble

```
SPP: 0008
Title: Transactions
Author: Smilepay
Status: Active
Created: 20-11-2021
Updated: 20-11-2021
Discussion: N/A
```

## Description
Transactions happen between any two Smilepay accounts. There are multiple types of transactions in the system because Smilepay has multiple accounts. Here is the format which all transactions follow:

![transaction sample](https://user-images.githubusercontent.com/57795945/142725837-5363b06d-09e5-4914-8711-476765605cbd.png)

<br />

In Smilepay, transactions between multiple accounts vary as the account type of the sender and recipient accounts determines the transaction type. As such the quota type & quota amount varies for each transaction types (SPP: 0011). Here are the different transaction types in Smilepay: 

a. Send <br /> 
b. Pay/Buy <br />
c. Recharge <br />
d. Withdraw <br />


![rrrrr](https://user-images.githubusercontent.com/57795945/142726243-42e4c7a9-d7a6-4c4e-943d-4f4c40fd6cf6.PNG)

<br />

**a. Send** <br /> 
Is a type of transaction that happens when both the sender & receipient accounts are personal accounts or during a self transaction. This transaction type includes:
- P2P (personal-to-personal) transactions
- A2A (agent-to-agent) transactions 
- P2B (person-to-business) transactions (ONLY DURING A SELF TRANSACTION)
- B2P (business-to-person) transactions (ONLY DURING A SELF TRANSACTION)

<br />

**b. Pay/Buy** <br />
Is a type of transaction that happens when a business account is on either side of the transaction. This is when either the sender is a business account or the receipient is a business account or both sender & recipient accounts accounts are business accounts. This transaction type includes: 
- P2B (personal-to-business) transactions 
- B2P (business-to-personal) transactions
- B2B (business-to-business) transactions

> **Note:** <br />
> - Buy is something which is bought (product), while pay is money given in return for work, salary or wages (service). As such this is the recommended use of this terms for the above transaction type when it comes to user interface. Use the term "Buy" when users are buying products & use the term "Pay" when users are paying for a service. <br /> <br />
> - When the business account is an online business account type, users are not required to write recipient accounts as the system already knows it. 

<br />

**c. Recharge** <br />
Is a type of transaction that happens when the sender account is an agent account & the agent account can be any of the 4 agent account types. This transaction type includes: 
- A2P (agent-to-personal) transactions 
- D2P (distro_agent/super_agent/-to-personal) transactions 
- D2B (distro_agent/super_agent/-to-business) transactions 
- D2A (distro_agent/super_agent/-to-other_agents) transactions

<br />

**d. Withdraw** <br />
Is a type of transaction that happens when the recipient account is an agent account & the agent account can be any of the 4 agent account types. This transaction type includes:
- P2A (personal-to-agent) transactions
- P2D (personal-to-distro_agent/super_agent/) transactions 
- B2D (business-to-distro_agent/super_agent/) transactions 

<br />

### **Invalid Transactions**
Smilepay's business rules dictate that not all transactions between all smilepay accounts are allowed. Here are those transactions that are blocked:
 - A2B (agent-to-business) transactions
 - B2A (business-to-agent) transactions
 - A2D (agent-to-distro_agent/super_agent/) transactions
 - D2D (distro_agent/super_agent/-to-distro_agent/super_agent/) transactions

<br />

### **Request**
Is not a type of transaction but is part of the transactional features. Request is a feature that enables users to request money from anyone only a specific few times in a given time (usually is three times a day).
   
<br /> 

### **Self Transaction**
This is a type of transaction that happens between the multiple accounts of one user, like when a users sends money from their business account to there personal account. Here are the possible transactions and the invalid once:

![sf](https://user-images.githubusercontent.com/57795945/142725312-18e82026-9ed6-4280-be69-b2c71bb65571.PNG)

Here are the invalid transactions that are blocked in a self transaction:
- P2P (person-to-person) transactions
- B2B (business-to-business) transactions
- A2B (agent-to-business) transactions
- P2A (person-to-agent) transactions
- B2A (business-to-agent) transactions
- A2A (agent-to-agent) transactions

And here are the transctions that are allowed in a self transaction:
- P2B (person-to-business) transactions
- B2P (business-to-person) transactions 
- A2P (agent-to-person) transactions 

<br />

### **Transaction Remark**
Is a an optional process in any transaction that users use to label their transactions. There are two types of transactional remark's for any Smilepay transactions: <br />

<br />

a. Sender Remark <br />
   Is a type of transactional remark were users write a label to the transaction they are sending. <br /> 

<br />

b. Recipient Remark <br />
   Is a type of transactional remark were users write a label to a transaction they received. <br />
   
<br />

### **Payment Password /Transaction Lock/**
Is a mandatory password required when making payments, transfers and any changes to your funds. The importance of this security feature is equivalent to that of a credit card security code, which consists of 6 digits.

<br />

## Specification
### **Transaction ID /Txn ID/**
Transaction ID is a 12 digits Alphanumeric used to trace transactions and is required by NBE license. Here are the 36 possible alphanumerics for each 12 digits:  
``` 
    | No. of  | Alpha   | 
    | Possib. | Numeric |
    | ------  | ------- |
    |    1	  |    0    |
    |    2	  |    1    |
    |    3	  |    2    |
    |    4	  |    3    |
    |    5	  |    4    |
    |    6	  |    5    |
    |    7	  |    6    |
    |    8	  |    7    |
    |    9	  |    8    |
    |   10	  |    9    |
    |   11    |    A    |
    |   12	  |    B    |
    |   13	  |    C    |
    |   14	  |    D    |
    |   15    |    E    |
    |   16	  |    F    |
    |   17	  |    G    |
    |   18	  |    H    |
    |   19	  |    I    |
    |   20	  |    J    |
    |   21	  |    K    |
    |   22	  |    L    |
    |   23	  |    M    |
    |   24	  |    N    |
    |   25	  |    O    |
    |   26	  |    P    |
    |   27	  |    Q    |
    |   28	  |    R    |
    |   29	  |    S    |
    |   30	  |    T    |
    |   31	  |    U    |
    |   32	  |    V    |
    |   33	  |    W    |
    |   34	  |    X    |
    |   35	  |    Y    |
    |   36	  |    Z    |
```

<br />

To calculate the possible number of combinations for a Transaction ID we need to calculate the 36 Possibilities for each 12 digit. <br />

The Formula:
> 36^12 = 4.738381338 E+18 <br />
> &emsp;&emsp;&emsp; = 4,738,381,338,321,616,896 <br /> 
> &emsp;&emsp;&emsp; = 4.7 Quintillion Possibilities 
                   
This means there are more than 4.7 Quintillion possible transaction ID's to be assigned for each transactions. Here are some examples:
```
XYZ 000 ABC DEF
.
.
.
XYZ 000 ABC DEZ
XYZ 000 ABC DF0
.
.
.
XYZ 000 ABC DFZ
XYZ 000 ABC DG0
.
.
.
XYZ 000 ABC DGZ
XYZ 000 ABC DH0
.
.
.
XYZ 000 ABC DHZ
XYZ 000 ABC DI0
```

<br />

## Security Concerns
**Security Concern 1:** <br />
Executing some transactions is a security concern for the businesses. As such based on the business rules some of this transactions have been labeled invalid transactions and blocked.
